<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barbershop Terminbuchung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;500;600;700&family=Squada+One&family=Oswald:wght@300;400;500;600;700&family=Bebas+Neue&family=Anton&display=swap');
        body { font-family: var(--text-font, 'Inter'), sans-serif; }
        h1, h2, h3, .title-font { font-family: var(--title-font, 'Squada One'), cursive; font-size: 1.2em; }
        h1 { font-size: 2.5rem; }
        h2 { font-size: 1.8rem; }
        h3 { font-size: 1.4rem; }
        .gradient-bg { background: linear-gradient(135deg, var(--primary-color, #2563eb) 0%, var(--secondary-color, #1e40af) 100%); }
        .glass-effect { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.1); }
        .booking-card { transition: all 0.3s ease; }
        .booking-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .logo-container { width: 80px; height: 80px; border-radius: 50%; overflow: hidden; margin: 0 auto 1rem; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; }
        .logo-container img { width: 100%; height: 100%; object-fit: cover; }
        .whatsapp-btn { background: #25D366; color: white; }
        .whatsapp-btn:hover { background: #128C7E; }
        .design-panel { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .design-panel.open { max-height: 80vh; overflow-y: auto; }
        .design-panel::-webkit-scrollbar { width: 8px; }
        .design-panel::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); border-radius: 4px; }
        .design-panel::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
        .design-panel::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.5); }
        .draggable-service { cursor: move; transition: all 0.3s ease; }
        .draggable-service:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .draggable-service.dragging { opacity: 0.5; transform: rotate(5deg); }
        .drop-zone { border: 2px dashed rgba(255,255,255,0.3); border-radius: 8px; padding: 20px; margin: 10px 0; transition: all 0.3s ease; }
        .drop-zone.drag-over { border-color: #10b981; background: rgba(16, 185, 129, 0.1); }
        .category-container { border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; padding: 15px; margin: 10px 0; }
        .service-item { background: rgba(255,255,255,0.05); border-radius: 6px; padding: 10px; margin: 5px 0; }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div id="logoContainer" class="logo-container">
                <span class="text-3xl">‚úÇÔ∏è</span>
            </div>
            <h1 class="text-4xl font-bold text-white mb-2" id="businessName">Barbershop Elite</h1>
            <p class="text-white/80 text-lg">Professionelle Herrenfriseur-Services</p>
        </div>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto">
            <!-- Booking Form -->
            <div id="bookingForm" class="glass-effect rounded-2xl p-8 mb-8">
                <h2 class="text-2xl font-semibold text-white mb-6">üóìÔ∏è Termin buchen</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Service Selection -->
                    <div>
                        <label class="block text-white font-medium mb-3">Service w√§hlen</label>
                        <div id="servicesList" class="space-y-3">
                            <!-- Services will be loaded here -->
                        </div>
                    </div>

                    <!-- Date & Time Selection -->
                    <div>
                        <label class="block text-white font-medium mb-3">Datum & Uhrzeit</label>
                        <div class="space-y-4">
                            <input type="date" id="bookingDate" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            
                            <div id="timeSlots" class="grid grid-cols-3 gap-2">
                                <!-- Time slots will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Services -->
                <div class="mt-6">
                    <label class="block text-white font-medium mb-3" id="additionalServicesLabel">Zus√§tzliche Services (optional)</label>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <label class="flex items-center text-white bg-white/5 rounded-lg p-3 hover:bg-white/10 transition-all cursor-pointer">
                            <input type="checkbox" id="designService" class="mr-3 w-4 h-4 accent-purple-600">
                            <div>
                                <span class="font-medium" id="designServiceName">üé® Premium Design</span>
                                <p class="text-white/70 text-sm" id="designServiceDesc">Spezielle Styling-Beratung (+<span id="designServicePrice">15</span> CHF)</p>
                            </div>
                        </label>
                        <label class="flex items-center text-white bg-white/5 rounded-lg p-3 hover:bg-white/10 transition-all cursor-pointer">
                            <input type="checkbox" id="stylingService" class="mr-3 w-4 h-4 accent-purple-600">
                            <div>
                                <span class="font-medium" id="stylingServiceName">‚ú® Styling Service</span>
                                <p class="text-white/70 text-sm" id="stylingServiceDesc">Komplettes Haarstyling (+<span id="stylingServicePrice">20</span> CHF)</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Customer Info -->
                <div class="mt-6 grid md:grid-cols-2 gap-4">
                    <input type="text" id="customerName" placeholder="Ihr Name" class="p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                    <input type="tel" id="customerPhone" placeholder="+41 XX XXX XX XX" class="p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                </div>

                <!-- Booking Summary -->
                <div id="bookingSummary" class="mt-6 bg-white/10 rounded-lg p-4 hidden">
                    <h3 class="text-white font-medium mb-2">Buchungs√ºbersicht</h3>
                    <div id="summaryContent" class="text-white/80 text-sm"></div>
                </div>

                <!-- Book Button -->
                <button id="bookButton" class="w-full mt-6 bg-white text-purple-600 font-semibold py-3 px-6 rounded-lg hover:bg-white/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Termin buchen
                </button>
            </div>

            <!-- Admin Panel Toggle -->
            <div class="text-center mb-4">
                <button id="adminToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-4 py-2 rounded-lg hover:bg-white/20 transition-all">
                    üîß Admin-Bereich
                </button>
            </div>

            <!-- Admin Panel -->
            <div id="adminPanel" class="glass-effect rounded-2xl p-8 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-white">üë®‚Äçüíº Admin-Bereich</h2>
                    <div class="space-x-2">
                        <button id="serviceToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            ‚öôÔ∏è Services
                        </button>
                        <button id="designToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üé® Design
                        </button>
                        <button id="whatsappToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üì± WhatsApp
                        </button>
                        <button id="hoursToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üïí Arbeitszeiten
                        </button>
                        <button id="textToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üìù Texte
                        </button>
                        <button id="logoutButton" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üö™ Abmelden
                        </button>
                    </div>
                </div>

                <!-- Service Management Panel -->
                <div id="servicePanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">‚öôÔ∏è Services verwalten & organisieren</h3>
                    
                    <!-- View Toggle -->
                    <div class="mb-6 flex gap-2">
                        <button id="viewEditMode" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-all">
                            ‚úèÔ∏è Bearbeiten
                        </button>
                        <button id="viewOrganizeMode" class="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-purple-700 transition-all">
                            üîÑ Organisieren (Drag & Drop)
                        </button>
                    </div>

                    <!-- Edit Mode -->
                    <div id="editModeContent">
                        <!-- Create New Category -->
                        <div class="bg-blue-500/20 rounded-lg p-4 mb-6">
                            <h4 class="text-white font-medium mb-3">üèóÔ∏è Neue Kategorie erstellen</h4>
                            <div class="grid md:grid-cols-3 gap-3 mb-3">
                                <input type="text" id="newCategoryName" placeholder="Kategorie Name (z.B. Haarschnitte)" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="text" id="newCategoryEmoji" placeholder="Emoji (z.B. ‚úÇÔ∏è)" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <button id="createCategoryBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                    üèóÔ∏è Kategorie erstellen
                                </button>
                            </div>
                            
                            <!-- Create Subcategory -->
                            <div class="border-t border-white/10 pt-3">
                                <h5 class="text-white/80 font-medium mb-2">üìã Unterkategorie hinzuf√ºgen</h5>
                                <div class="grid md:grid-cols-3 gap-3">
                                    <select id="selectCategoryForSub" class="p-3 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                        <option value="">Kategorie w√§hlen</option>
                                    </select>
                                    <input type="text" id="newSubcategoryName" placeholder="Unterkategorie Name (z.B. Klassisch)" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    <button id="createSubcategoryBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-medium transition-all">
                                        üìã Unterkategorie hinzuf√ºgen
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Add New Service -->
                        <div class="bg-white/5 rounded-lg p-4 mb-6">
                            <h4 class="text-white font-medium mb-3">‚ûï Neuen Service hinzuf√ºgen</h4>
                            <div class="grid md:grid-cols-2 gap-3">
                                <input type="text" id="newServiceName" placeholder="Service Name" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="text" id="newServiceDescription" placeholder="Beschreibung" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            </div>
                            <div class="grid md:grid-cols-4 gap-3 mt-3">
                                <input type="number" id="newServicePrice" placeholder="Preis CHF" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="number" id="newServiceDuration" placeholder="Dauer Min" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="text" id="newServiceEmoji" placeholder="Emoji (z.B. ‚úÇÔ∏è)" class="p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <select id="newServiceCategory" class="p-3 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    <option value="">Kategorie w√§hlen</option>
                                    <option value="simple">Einfacher Service</option>
                                </select>
                            </div>
                            <div class="mt-3">
                                <label class="flex items-center text-white">
                                    <input type="checkbox" id="newServiceFeatured" class="mr-3 w-4 h-4 accent-purple-600">
                                    üé® Premium Design (Service hervorheben)
                                </label>
                                <p class="text-white/60 text-xs mt-1">Aktiviert spezielle Styling-Effekte f√ºr diesen Service</p>
                            </div>
                            <div class="grid md:grid-cols-2 gap-3 mt-3" id="subcategorySelection" style="display: none;">
                                <select id="newServiceSubcategory" class="p-3 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    <option value="">Unterkategorie w√§hlen</option>
                                </select>
                            </div>
                            <div class="mt-4">
                                <button id="addServiceBtn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-all">
                                    ‚ûï Service hinzuf√ºgen
                                </button>
                            </div>
                        </div>

                        <!-- Individual Service Editing -->
                        <div id="serviceEditingSections" class="space-y-4">
                            <!-- Service editing sections will be loaded here -->
                        </div>
                    </div>

                    <!-- Organize Mode -->
                    <div id="organizeModeContent" class="hidden">
                        <div class="bg-blue-500/20 rounded-lg p-4 mb-6">
                            <h4 class="text-white font-medium mb-2">üîÑ Services per Drag & Drop organisieren</h4>
                            <p class="text-white/80 text-sm mb-2">
                                Ziehen Sie Services zwischen Kategorien um sie zu verschieben:
                            </p>
                            <ul class="text-white/70 text-sm space-y-1 ml-4">
                                <li>‚Ä¢ Services innerhalb einer Kategorie verschieben</li>
                                <li>‚Ä¢ Services zwischen Kategorien verschieben</li>
                                <li>‚Ä¢ Neue Kategorien werden automatisch erstellt</li>
                            </ul>
                        </div>

                        <div id="dragDropServiceContainer">
                            <!-- Drag & Drop interface will be loaded here -->
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mt-6 flex gap-4 flex-wrap">
                        <button id="saveAllServices" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ Alle Services speichern
                        </button>
                        <button id="previewAllServices" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all">
                            üëÅÔ∏è Alle √Ñnderungen vorschauen
                        </button>
                        <button id="resetAllServices" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-red-700 transition-all">
                            üîÑ Alle Services zur√ºcksetzen
                        </button>
                    </div>
                </div>

                <!-- Design Panel -->
                <div id="designPanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">üé® Design & Texte bearbeiten</h3>
                    
                    <div class="space-y-6">
                        <!-- Logo & Business Name Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üè™ Logo & Gesch√§ftsname</h4>
                            <div class="grid md:grid-cols-2 gap-4">
                                <!-- Logo Upload -->
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Logo hochladen</label>
                                    <input type="file" id="logoUpload" accept="image/*" class="w-full p-2 rounded-lg bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-white file:text-purple-600 hover:file:bg-gray-100">
                                    <p class="text-white/50 text-xs mt-1">JPG, PNG oder GIF (max. 2MB)</p>
                                </div>

                                <!-- Business Name -->
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Gesch√§ftsname</label>
                                    <input type="text" id="businessNameInput" placeholder="Barbershop Elite" class="w-full p-2 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                            </div>
                        </div>

                        <!-- Main Title Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üìù Haupttitel bearbeiten</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Titel-Text</label>
                                    <input type="text" id="editMainTitleDesign" placeholder="Barbershop Elite" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="mainTitleSizeDesign" value="2.5" step="0.1" min="1" max="5" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="mainTitleFontDesign" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Squada One">Squada One</option>
                                            <option value="Oswald">Oswald</option>
                                            <option value="Bebas Neue">Bebas Neue</option>
                                            <option value="Anton">Anton</option>
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                        </select>
                                    </div>
                                </div>
                                <button id="applyMainTitle" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Subtitle Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üìÑ Untertitel bearbeiten</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Untertitel-Text</label>
                                    <input type="text" id="editSubtitleDesign" placeholder="Professionelle Herrenfriseur-Services" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="subtitleSizeDesign" value="1.125" step="0.1" min="0.5" max="3" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="subtitleFontDesign" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                            <option value="Open Sans">Open Sans</option>
                                        </select>
                                    </div>
                                </div>
                                <button id="applySubtitle" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Booking Form Title Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üóìÔ∏è Buchungsformular Titel</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Formular-Titel</label>
                                    <input type="text" id="editBookingTitleDesign" placeholder="üóìÔ∏è Termin buchen" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="bookingTitleSizeDesign" value="1.5" step="0.1" min="0.5" max="3" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="bookingTitleFontDesign" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Squada One">Squada One</option>
                                            <option value="Oswald">Oswald</option>
                                        </select>
                                    </div>
                                </div>
                                <button id="applyBookingTitle" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Form Labels Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üè∑Ô∏è Formularlabels bearbeiten</h4>
                            <div class="space-y-3">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Service-Label</label>
                                        <input type="text" id="editServiceLabelDesign" placeholder="Service w√§hlen" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Datum-Label</label>
                                        <input type="text" id="editDateLabelDesign" placeholder="Datum & Uhrzeit" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Name-Platzhalter</label>
                                        <input type="text" id="editNamePlaceholderDesign" placeholder="Ihr Name" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Telefon-Platzhalter</label>
                                        <input type="text" id="editPhonePlaceholderDesign" placeholder="+41 XX XXX XX XX" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Label-Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="labelSizeDesign" value="1" step="0.1" min="0.5" max="2" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Label-Schriftart</label>
                                        <select id="labelFontDesign" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                        </select>
                                    </div>
                                </div>
                                <button id="applyLabels" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Button Text Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üîò Button-Text bearbeiten</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Button-Text</label>
                                    <input type="text" id="editButtonTextDesign" placeholder="Termin buchen" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="buttonTextSizeDesign" value="1" step="0.1" min="0.5" max="2" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="buttonTextFontDesign" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                        </select>
                                    </div>
                                </div>
                                <button id="applyButton" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Additional Services Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üéØ Zus√§tzliche Services bearbeiten</h4>
                            <div class="space-y-4">
                                <!-- Section Title -->
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Bereich-Titel</label>
                                    <input type="text" id="editAdditionalServicesLabel" placeholder="Zus√§tzliche Services (optional)" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                
                                <!-- Design Service -->
                                <div class="border border-white/10 rounded-lg p-3">
                                    <h5 class="text-white/80 font-medium mb-2">Service 1 (Premium Design)</h5>
                                    <div class="grid grid-cols-2 gap-3 mb-2">
                                        <div>
                                            <label class="block text-white/70 text-xs mb-1">Name</label>
                                            <input type="text" id="editDesignServiceName" placeholder="üé® Premium Design" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                        </div>
                                        <div>
                                            <label class="block text-white/70 text-xs mb-1">Preis (CHF)</label>
                                            <input type="number" id="editDesignServicePrice" value="15" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-xs mb-1">Beschreibung</label>
                                        <input type="text" id="editDesignServiceDesc" placeholder="Spezielle Styling-Beratung" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                    </div>
                                </div>
                                
                                <!-- Styling Service -->
                                <div class="border border-white/10 rounded-lg p-3">
                                    <h5 class="text-white/80 font-medium mb-2">Service 2 (Styling Service)</h5>
                                    <div class="grid grid-cols-2 gap-3 mb-2">
                                        <div>
                                            <label class="block text-white/70 text-xs mb-1">Name</label>
                                            <input type="text" id="editStylingServiceName" placeholder="‚ú® Styling Service" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                        </div>
                                        <div>
                                            <label class="block text-white/70 text-xs mb-1">Preis (CHF)</label>
                                            <input type="number" id="editStylingServicePrice" value="20" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-xs mb-1">Beschreibung</label>
                                        <input type="text" id="editStylingServiceDesc" placeholder="Komplettes Haarstyling" class="w-full p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none text-sm">
                                    </div>
                                </div>
                                
                                <button id="applyAdditionalServices" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                    ‚ú® Sofort anwenden
                                </button>
                            </div>
                        </div>

                        <!-- Colors Section -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-4">üé® Farben anpassen</h4>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Hauptfarbe</label>
                                    <div class="flex gap-2">
                                        <input type="text" id="primaryColorInput" placeholder="#2563eb" class="flex-1 p-2 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                        <input type="color" id="primaryColorPicker" class="w-10 h-10 rounded border border-white/20 bg-white/10">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Zweitfarbe</label>
                                    <div class="flex gap-2">
                                        <input type="text" id="secondaryColorInput" placeholder="#1e40af" class="flex-1 p-2 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                        <input type="color" id="secondaryColorPicker" class="w-10 h-10 rounded border border-white/20 bg-white/10">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button id="saveDesign" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ Alles speichern
                        </button>
                        <button id="resetDesign" class="bg-white/20 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/30 transition-all">
                            üîÑ Zur√ºcksetzen
                        </button>
                        <button id="previewAllChanges" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-green-700 transition-all">
                            üëÅÔ∏è Alle √Ñnderungen vorschauen
                        </button>
                    </div>
                </div>

                <!-- Working Hours Panel -->
                <div id="hoursPanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">üïí Arbeitszeiten verwalten</h3>
                    
                    <div class="space-y-6">
                        <!-- Days of Week -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="space-y-3">
                                <h4 class="text-white font-medium">Wochentage aktivieren</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="dayMonday" class="mr-3 w-4 h-4" checked>
                                        Montag
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="dayTuesday" class="mr-3 w-4 h-4" checked>
                                        Dienstag
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="dayWednesday" class="mr-3 w-4 h-4" checked>
                                        Mittwoch
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="dayThursday" class="mr-3 w-4 h-4" checked>
                                        Donnerstag
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="dayFriday" class="mr-3 w-4 h-4" checked>
                                        Freitag
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="daySaturday" class="mr-3 w-4 h-4">
                                        Samstag
                                    </label>
                                    <label class="flex items-center text-white">
                                        <input type="checkbox" id="daySunday" class="mr-3 w-4 h-4">
                                        Sonntag
                                    </label>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <h4 class="text-white font-medium">Arbeitszeiten</h4>
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">√ñffnung</label>
                                        <input type="time" id="openTime" value="09:00" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schlie√üung</label>
                                        <input type="time" id="closeTime" value="18:00" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Mittagspause Start</label>
                                        <input type="time" id="breakStart" value="12:00" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Mittagspause Ende</label>
                                        <input type="time" id="breakEnd" value="13:00" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-white/70 text-sm mb-1">Termin-Intervall (Minuten)</label>
                                    <select id="timeInterval" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                        <option value="15">15 Minuten</option>
                                        <option value="30" selected>30 Minuten</option>
                                        <option value="60">60 Minuten</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Custom Time Slots -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Individuelle Zeitslots hinzuf√ºgen</h4>
                            <div class="flex gap-2 mb-3">
                                <input type="time" id="customTimeSlot" class="p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                <button id="addTimeSlot" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded transition-all">
                                    ‚ûï Hinzuf√ºgen
                                </button>
                            </div>
                            <div id="customTimeSlots" class="flex flex-wrap gap-2">
                                <!-- Custom time slots will appear here -->
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button id="saveHours" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ Arbeitszeiten speichern
                        </button>
                        <button id="resetHours" class="bg-white/20 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/30 transition-all">
                            üîÑ Zur√ºcksetzen
                        </button>
                    </div>
                </div>

                <!-- Text Editing Panel -->
                <div id="textPanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">üìù Alle Texte bearbeiten</h3>
                    
                    <div class="space-y-6">
                        <!-- Main Title -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Haupttitel</h4>
                            <div class="space-y-3">
                                <input type="text" id="editMainTitle" placeholder="Barbershop Elite" class="w-full p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="mainTitleSize" value="2.5" step="0.1" min="1" max="5" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="mainTitleFont" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Squada One">Squada One</option>
                                            <option value="Oswald">Oswald</option>
                                            <option value="Bebas Neue">Bebas Neue</option>
                                            <option value="Anton">Anton</option>
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Subtitle -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Untertitel</h4>
                            <div class="space-y-3">
                                <input type="text" id="editSubtitle" placeholder="Professionelle Herrenfriseur-Services" class="w-full p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="subtitleSize" value="1.125" step="0.1" min="0.5" max="3" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="subtitleFont" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                            <option value="Open Sans">Open Sans</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Booking Form Title -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Buchungsformular Titel</h4>
                            <div class="space-y-3">
                                <input type="text" id="editBookingTitle" placeholder="üóìÔ∏è Termin buchen" class="w-full p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="bookingTitleSize" value="1.5" step="0.1" min="0.5" max="3" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="bookingTitleFont" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Squada One">Squada One</option>
                                            <option value="Oswald">Oswald</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Button Text -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Button-Text</h4>
                            <div class="space-y-3">
                                <input type="text" id="editButtonText" placeholder="Termin buchen" class="w-full p-3 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="buttonTextSize" value="1" step="0.1" min="0.5" max="2" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Schriftart</label>
                                        <select id="buttonTextFont" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Labels -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Formularlabels</h4>
                            <div class="space-y-3">
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="editServiceLabel" placeholder="Service w√§hlen" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    <input type="text" id="editDateLabel" placeholder="Datum & Uhrzeit" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <input type="text" id="editNamePlaceholder" placeholder="Ihr Name" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                    <input type="text" id="editPhonePlaceholder" placeholder="+41 XX XXX XX XX" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Label-Schriftgr√∂√üe (rem)</label>
                                        <input type="number" id="labelSize" value="1" step="0.1" min="0.5" max="2" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-white/70 text-sm mb-1">Label-Schriftart</label>
                                        <select id="labelFont" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                            <option value="Inter">Inter</option>
                                            <option value="Poppins">Poppins</option>
                                            <option value="Roboto">Roboto</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button id="saveTexts" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ Texte speichern
                        </button>
                        <button id="resetTexts" class="bg-white/20 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/30 transition-all">
                            üîÑ Zur√ºcksetzen
                        </button>
                        <button id="previewTexts" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all">
                            üëÅÔ∏è Vorschau
                        </button>
                    </div>
                </div>

                <!-- WhatsApp Panel -->
                <div id="whatsappPanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">üì± WhatsApp Einstellungen</h3>
                    
                    <div class="space-y-6">
                        <!-- Owner WhatsApp -->
                        <div>
                            <label class="block text-white font-medium mb-3">Inhaber WhatsApp-Nummer</label>
                            <input type="tel" id="ownerWhatsApp" placeholder="+49123456789" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            <p class="text-white/60 text-sm mt-2">Diese Nummer erh√§lt Benachrichtigungen bei neuen Buchungen</p>
                        </div>

                        <!-- Auto Notification -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <label class="flex items-center text-white font-medium">
                                <input type="checkbox" id="autoNotifyOwner" class="mr-3 w-4 h-4">
                                Automatische Benachrichtigung aktivieren
                            </label>
                            <p class="text-white/60 text-sm mt-2 ml-7">Bei jeder neuen Buchung wird automatisch eine WhatsApp-Nachricht an den Inhaber gesendet</p>
                        </div>

                        <!-- Test Message -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Test-Nachricht senden</h4>
                            <p class="text-white/60 text-sm mb-3">Teste die WhatsApp-Benachrichtigung mit einer Beispiel-Nachricht</p>
                            <button id="testWhatsApp" class="whatsapp-btn px-4 py-2 rounded-lg font-medium transition-all">
                                üì± Test-Nachricht senden
                            </button>
                        </div>

                        <!-- Message Templates -->
                        <div class="bg-white/5 rounded-lg p-4">
                            <h4 class="text-white font-medium mb-3">Nachrichten-Vorlagen</h4>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Kundenbest√§tigung</label>
                                    <textarea id="customerTemplate" rows="4" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none resize-none" placeholder="‚úÖ Buchungsbest√§tigung

Hallo {name}!

Ihr Termin wurde erfolgreich gebucht:
üìÖ {date} um {time}
‚úÇÔ∏è {service}
üí∞ {price} CHF

Wir freuen uns auf Ihren Besuch!

{businessName}"></textarea>
                                </div>

                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Inhaber-Benachrichtigung</label>
                                    <textarea id="ownerTemplate" rows="4" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none resize-none" placeholder="üîî Neue Buchung!

Kunde: {name}
üìû {phone}
üìÖ {date} um {time}
‚úÇÔ∏è {service}
üí∞ {price} CHF

{businessName} - Admin"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button id="saveWhatsApp" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ WhatsApp-Einstellungen speichern
                        </button>
                        <button id="resetWhatsApp" class="bg-white/20 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/30 transition-all">
                            üîÑ Zur√ºcksetzen
                        </button>
                    </div>
                </div>
                
                <!-- Bookings List -->
                <div class="mb-6">
                    <h3 class="text-white font-medium mb-4">Heutige Termine</h3>
                    <div id="bookingsList" class="space-y-3">
                        <!-- Bookings will be displayed here -->
                    </div>
                </div>

                <!-- Statistics -->
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="todayBookings">0</div>
                        <div class="text-white/70 text-sm">Heute</div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="todayRevenue">0 CHF</div>
                        <div class="text-white/70 text-sm">Umsatz</div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="totalBookings">0</div>
                        <div class="text-white/70 text-sm">Gesamt</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let selectedService = null;
        let selectedDate = null;
        let selectedTime = null;
        let bookings = JSON.parse(localStorage.getItem('barbershop_bookings')) || [];
        let services = JSON.parse(localStorage.getItem('barbershop_services')) || [];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadDesignSettings();
        });

        function initializeApp() {
            loadServices();
            setupServiceSelection();
            setupDateSelection();
            setupAdminPanel();
            setupDesignPanel();
            setupServiceManagement();
            setupWorkingHoursPanel();
            setupTextEditingPanel();
            setupWhatsAppPanel();
            updateAdminStats();
            setMinDate();
            updateCategoryDropdowns();
            setupAdditionalServices();
            
            // Load saved text settings on startup
            const savedTextSettings = localStorage.getItem('barbershop_textSettings');
            if (savedTextSettings) {
                applyTextSettings(JSON.parse(savedTextSettings));
            }
        }

        function setupAdditionalServices() {
            // Add event listeners for additional service checkboxes
            document.getElementById('designService').addEventListener('change', updateBookingSummary);
            document.getElementById('stylingService').addEventListener('change', updateBookingSummary);
        }

        function updateCategoryDropdowns() {
            // Update category dropdown for new services
            const newServiceCategorySelect = document.getElementById('newServiceCategory');
            if (newServiceCategorySelect) {
                // Keep existing options and add new categories
                const currentOptions = Array.from(newServiceCategorySelect.options).map(opt => opt.value);
                
                services.forEach(service => {
                    if (service.type === 'category' && !currentOptions.includes(service.id.toString())) {
                        const option = document.createElement('option');
                        option.value = service.id;
                        option.textContent = `${service.emoji} ${service.name}`;
                        newServiceCategorySelect.appendChild(option);
                    }
                });
            }

            // Update category dropdown for subcategory creation
            const selectCategoryForSub = document.getElementById('selectCategoryForSub');
            if (selectCategoryForSub) {
                selectCategoryForSub.innerHTML = '<option value="">Kategorie w√§hlen</option>';
                
                services.forEach(service => {
                    if (service.type === 'category') {
                        const option = document.createElement('option');
                        option.value = service.id;
                        option.textContent = `${service.emoji} ${service.name}`;
                        selectCategoryForSub.appendChild(option);
                    }
                });
            }
        }

        function setMinDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('bookingDate').min = today;
        }

        let currentServicePath = [];
        let serviceNavigationStack = [];

        function loadServices() {
            const servicesList = document.getElementById('servicesList');
            servicesList.innerHTML = '';
            
            // Add navigation breadcrumb if we're in a subcategory
            if (currentServicePath.length > 0) {
                const breadcrumb = document.createElement('div');
                breadcrumb.className = 'mb-4 flex items-center gap-2 text-white/70 text-sm';
                breadcrumb.innerHTML = `
                    <button onclick="goBackInServices()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded transition-all">
                        ‚Üê Zur√ºck
                    </button>
                    <span>${currentServicePath.join(' > ')}</span>
                `;
                servicesList.appendChild(breadcrumb);
            }
            
            const currentServices = getCurrentServices();
            
            currentServices.forEach(service => {
                const serviceElement = document.createElement('div');
                serviceElement.className = 'service-option bg-white/10 rounded-lg p-4 cursor-pointer hover:bg-white/20 transition-all';
                
                if (service.type === 'category') {
                    // Category - shows subcategories
                    serviceElement.dataset.serviceId = service.id;
                    
                    // Calculate price range for category
                    const priceRange = getCategoryPriceRange(service);
                    
                    serviceElement.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="text-white font-medium">${service.emoji} ${service.name}</h3>
                                <p class="text-white/70 text-sm">Kategorie w√§hlen ‚Üí</p>
                            </div>
                            <div class="text-right">
                                <p class="text-white font-bold">${priceRange}</p>
                                <div class="text-white/50">
                                    <span class="text-2xl">‚Üí</span>
                                </div>
                            </div>
                        </div>
                    `;
                    serviceElement.addEventListener('click', () => navigateToCategory(service));
                } else if (service.type === 'subcategory') {
                    // Subcategory - shows final options
                    serviceElement.dataset.serviceId = service.id;
                    serviceElement.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="text-white font-medium">üìã ${service.name}</h3>
                                <p class="text-white/70 text-sm">Optionen anzeigen ‚Üí</p>
                            </div>
                            <div class="text-white/50">
                                <span class="text-2xl">‚Üí</span>
                            </div>
                        </div>
                    `;
                    serviceElement.addEventListener('click', () => navigateToSubcategory(service));
                } else {
                    // Final service option or simple service
                    serviceElement.dataset.serviceId = service.id;
                    // Apply premium styling if featured
                    const premiumClass = service.featured ? 'ring-2 ring-yellow-400 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 shadow-lg' : '';
                    const premiumIcon = service.featured ? '‚≠ê ' : '';
                    
                    serviceElement.className = `service-option bg-white/10 rounded-lg p-4 cursor-pointer hover:bg-white/20 transition-all ${premiumClass}`;
                    
                    serviceElement.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h3 class="text-white font-medium">${premiumIcon}${service.emoji || '‚úÇÔ∏è'} ${service.name}</h3>
                                <p class="text-white/70 text-sm">${service.description}</p>
                                ${service.featured ? '<p class="text-yellow-400 text-xs font-medium mt-1">‚ú® Premium Service</p>' : ''}
                            </div>
                            <div class="text-right">
                                <p class="text-white font-bold ${service.featured ? 'text-yellow-400' : ''}">${service.price} CHF</p>
                                <p class="text-white/70 text-sm">${service.duration} Min</p>
                            </div>
                        </div>
                    `;
                    serviceElement.addEventListener('click', () => selectFinalService(service));
                }
                
                servicesList.appendChild(serviceElement);
            });
        }

        function getCurrentServices() {
            if (currentServicePath.length === 0) {
                // Show main categories and simple services
                return services;
            } else if (currentServicePath.length === 1) {
                // Show subcategories of selected category
                const category = services.find(s => s.name === currentServicePath[0]);
                return category ? category.subcategories : [];
            } else if (currentServicePath.length === 2) {
                // Show final options of selected subcategory
                const category = services.find(s => s.name === currentServicePath[0]);
                if (category && category.subcategories) {
                    const subcategory = category.subcategories.find(s => s.name === currentServicePath[1]);
                    return subcategory ? subcategory.options : [];
                }
            }
            return [];
        }

        function getCategoryPriceRange(category) {
            if (!category.subcategories || category.subcategories.length === 0) {
                return 'Preis auf Anfrage';
            }

            let minPrice = Infinity;
            let maxPrice = -Infinity;

            category.subcategories.forEach(subcategory => {
                if (subcategory.options && subcategory.options.length > 0) {
                    subcategory.options.forEach(option => {
                        if (option.price < minPrice) minPrice = option.price;
                        if (option.price > maxPrice) maxPrice = option.price;
                    });
                }
            });

            if (minPrice === Infinity || maxPrice === -Infinity) {
                return 'Preis auf Anfrage';
            }

            if (minPrice === maxPrice) {
                return `${minPrice} CHF`;
            } else {
                return `${minPrice} CHF - ${maxPrice} CHF`;
            }
        }

        function navigateToCategory(category) {
            serviceNavigationStack.push([...currentServicePath]);
            currentServicePath = [category.name];
            loadServices();
        }

        function navigateToSubcategory(subcategory) {
            serviceNavigationStack.push([...currentServicePath]);
            currentServicePath.push(subcategory.name);
            loadServices();
        }

        function selectFinalService(service) {
            // Remove previous selection
            document.querySelectorAll('.service-option').forEach(opt => opt.classList.remove('ring-2', 'ring-white'));
            
            // Add selection to clicked option
            event.target.closest('.service-option').classList.add('ring-2', 'ring-white');
            
            selectedService = {
                id: service.id,
                name: service.name,
                price: service.price,
                duration: service.duration,
                emoji: service.emoji || '‚úÇÔ∏è',
                fullPath: currentServicePath.length > 0 ? currentServicePath.join(' > ') + ' > ' + service.name : service.name
            };
            
            updateBookingSummary();
            checkBookingComplete();
        }

        function goBackInServices() {
            if (serviceNavigationStack.length > 0) {
                currentServicePath = serviceNavigationStack.pop();
            } else {
                currentServicePath = [];
            }
            
            // Clear selection when navigating back
            selectedService = null;
            updateBookingSummary();
            checkBookingComplete();
            
            loadServices();
        }

        function loadAdminServices() {
            const serviceEditingSections = document.getElementById('serviceEditingSections');
            serviceEditingSections.innerHTML = '';
            
            // Add info about the category system
            const infoSection = document.createElement('div');
            infoSection.className = 'bg-green-500/20 rounded-lg p-4 mb-4';
            infoSection.innerHTML = `
                <h4 class="text-white font-medium mb-2">üöÄ Service-Management</h4>
                <p class="text-white/80 text-sm mb-2">
                    Erstellen Sie Ihre eigenen Service-Kategorien:
                </p>
                <ul class="text-white/70 text-sm space-y-1 ml-4">
                    <li>‚Ä¢ <strong>Einfache Services:</strong> Direkt buchbare Services</li>
                    <li>‚Ä¢ <strong>Kategorien:</strong> Organisieren Sie Services in Gruppen</li>
                    <li>‚Ä¢ <strong>Drag & Drop:</strong> Verschieben Sie Services zwischen Kategorien</li>
                    <li>‚Ä¢ <strong>Neue Kategorien:</strong> Ziehen Sie Services in die "Neue Kategorie" Zone</li>
                </ul>
                <p class="text-white/60 text-xs mt-2">
                    Beginnen Sie mit dem Hinzuf√ºgen Ihrer ersten Services!
                </p>
            `;
            serviceEditingSections.appendChild(infoSection);
            
            // Show all final services (flattened view for admin)
            const allFinalServices = getAllFinalServices();
            
            allFinalServices.forEach(service => {
                const serviceSection = document.createElement('div');
                serviceSection.className = 'bg-white/5 rounded-lg p-4';
                serviceSection.innerHTML = `
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="text-white font-medium flex items-center gap-2">
                            <span class="text-xl">${service.emoji || '‚úÇÔ∏è'}</span>
                            ${service.fullPath || service.name}
                        </h4>
                        <div class="text-white/60 text-xs">
                            ID: ${service.id}
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <!-- Service Name -->
                        <div>
                            <label class="block text-white/70 text-sm mb-1">Service Name</label>
                            <input type="text" id="serviceName_${service.id}" value="${service.name}" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                        </div>
                        
                        <!-- Service Description -->
                        <div>
                            <label class="block text-white/70 text-sm mb-1">Beschreibung</label>
                            <input type="text" id="serviceDescription_${service.id}" value="${service.description || ''}" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                        </div>
                        
                        <!-- Price and Duration -->
                        <div class="grid grid-cols-3 gap-3">
                            <div>
                                <label class="block text-white/70 text-sm mb-1">Preis (CHF)</label>
                                <input type="number" id="servicePrice_${service.id}" value="${service.price}" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-white/70 text-sm mb-1">Dauer (Min)</label>
                                <input type="number" id="serviceDuration_${service.id}" value="${service.duration}" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-white/70 text-sm mb-1">Emoji</label>
                                <input type="text" id="serviceEmoji_${service.id}" value="${service.emoji || '‚úÇÔ∏è'}" class="w-full p-2 rounded bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                            </div>
                        </div>
                        
                        <!-- Design Toggle -->
                        <div class="mt-3">
                            <label class="flex items-center text-white mb-3">
                                <input type="checkbox" id="serviceDesign_${service.id}" ${service.featured ? 'checked' : ''} class="mr-3 w-4 h-4 accent-purple-600">
                                üé® Premium Design (Hervorhebung)
                            </label>
                            <p class="text-white/60 text-xs mb-3">Aktiviert spezielle Styling-Effekte f√ºr diesen Service</p>
                        </div>
                        
                        <!-- Apply Button -->
                        <div class="mt-3">
                            <button onclick="applyServiceChanges(${service.id})" class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-all">
                                ‚ú® Sofort anwenden
                            </button>
                        </div>
                    </div>
                `;
                serviceEditingSections.appendChild(serviceSection);
            });
        }

        function getAllFinalServices() {
            const finalServices = [];
            
            services.forEach(service => {
                if (service.type === 'simple') {
                    // Simple service - add directly
                    finalServices.push({
                        ...service,
                        fullPath: service.name
                    });
                } else if (service.type === 'category' && service.subcategories) {
                    // Category with subcategories
                    service.subcategories.forEach(subcategory => {
                        if (subcategory.options) {
                            subcategory.options.forEach(option => {
                                finalServices.push({
                                    ...option,
                                    fullPath: `${service.name} > ${subcategory.name} > ${option.name}`
                                });
                            });
                        }
                    });
                }
            });
            
            return finalServices;
        }

        function setupServiceSelection() {
            // Service selection is now handled directly in loadServices()
            // No additional setup needed as each service type has its own click handler
        }

        function setupDateSelection() {
            const dateInput = document.getElementById('bookingDate');
            dateInput.addEventListener('change', function() {
                selectedDate = this.value;
                generateTimeSlots();
                updateBookingSummary();
                checkBookingComplete();
            });
        }

        function generateTimeSlots() {
            const timeSlotsContainer = document.getElementById('timeSlots');
            timeSlotsContainer.innerHTML = '';
            
            if (!selectedDate) return;
            
            // Get day of week (0 = Sunday, 1 = Monday, etc.)
            const selectedDateObj = new Date(selectedDate);
            const dayOfWeek = selectedDateObj.getDay();
            
            // Check if this day is enabled
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayId = 'day' + dayNames[dayOfWeek];
            const isDayEnabled = localStorage.getItem(`barbershop_${dayId}`) !== 'false';
            
            if (!isDayEnabled) {
                timeSlotsContainer.innerHTML = '<p class="text-white/70 text-center col-span-3">An diesem Tag geschlossen</p>';
                return;
            }
            
            // Get working hours settings
            const openTime = localStorage.getItem('barbershop_openTime') || '09:00';
            const closeTime = localStorage.getItem('barbershop_closeTime') || '18:00';
            const breakStart = localStorage.getItem('barbershop_breakStart') || '12:00';
            const breakEnd = localStorage.getItem('barbershop_breakEnd') || '13:00';
            const interval = parseInt(localStorage.getItem('barbershop_timeInterval') || '30');
            const customSlots = JSON.parse(localStorage.getItem('barbershop_customSlots') || '[]');
            
            // Generate time slots based on settings
            const times = generateAvailableTimes(openTime, closeTime, breakStart, breakEnd, interval, customSlots);
            
            if (times.length === 0) {
                timeSlotsContainer.innerHTML = '<p class="text-white/70 text-center col-span-3">Keine verf√ºgbaren Zeiten</p>';
                return;
            }
            
            times.forEach(time => {
                const isBooked = bookings.some(booking => 
                    booking.date === selectedDate && booking.time === time
                );
                
                const timeSlot = document.createElement('button');
                timeSlot.className = `p-2 rounded text-sm transition-all ${
                    isBooked 
                        ? 'bg-red-500/20 text-red-300 cursor-not-allowed' 
                        : 'bg-white/10 text-white hover:bg-white/20'
                }`;
                timeSlot.textContent = time;
                timeSlot.disabled = isBooked;
                
                if (!isBooked) {
                    timeSlot.addEventListener('click', function() {
                        // Remove previous selection
                        document.querySelectorAll('#timeSlots button').forEach(btn => {
                            btn.classList.remove('ring-2', 'ring-white');
                        });
                        
                        // Add selection
                        this.classList.add('ring-2', 'ring-white');
                        selectedTime = time;
                        updateBookingSummary();
                        checkBookingComplete();
                    });
                }
                
                timeSlotsContainer.appendChild(timeSlot);
            });
        }

        function generateAvailableTimes(openTime, closeTime, breakStart, breakEnd, interval, customSlots) {
            const times = [];
            
            // Convert time strings to minutes
            function timeToMinutes(timeStr) {
                const [hours, minutes] = timeStr.split(':').map(Number);
                return hours * 60 + minutes;
            }
            
            // Convert minutes to time string
            function minutesToTime(minutes) {
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
            }
            
            const openMinutes = timeToMinutes(openTime);
            const closeMinutes = timeToMinutes(closeTime);
            const breakStartMinutes = timeToMinutes(breakStart);
            const breakEndMinutes = timeToMinutes(breakEnd);
            
            // Generate regular intervals
            for (let minutes = openMinutes; minutes < closeMinutes; minutes += interval) {
                // Skip break time
                if (minutes >= breakStartMinutes && minutes < breakEndMinutes) {
                    continue;
                }
                times.push(minutesToTime(minutes));
            }
            
            // Add custom slots
            customSlots.forEach(slot => {
                const slotMinutes = timeToMinutes(slot);
                if (slotMinutes >= openMinutes && slotMinutes < closeMinutes && 
                    !(slotMinutes >= breakStartMinutes && slotMinutes < breakEndMinutes)) {
                    if (!times.includes(slot)) {
                        times.push(slot);
                    }
                }
            });
            
            // Sort times
            times.sort();
            
            return times;
        }

        function updateBookingSummary() {
            const summary = document.getElementById('bookingSummary');
            const content = document.getElementById('summaryContent');
            
            if (selectedService && selectedDate && selectedTime) {
                // Calculate additional services with saved prices
                let additionalServices = [];
                let additionalPrice = 0;
                
                if (document.getElementById('designService').checked) {
                    const designPrice = parseInt(localStorage.getItem('barbershop_design_service_price') || '15');
                    const designName = localStorage.getItem('barbershop_design_service_name') || 'üé® Premium Design';
                    additionalServices.push(`${designName} (+${designPrice} CHF)`);
                    additionalPrice += designPrice;
                }
                
                if (document.getElementById('stylingService').checked) {
                    const stylingPrice = parseInt(localStorage.getItem('barbershop_styling_service_price') || '20');
                    const stylingName = localStorage.getItem('barbershop_styling_service_name') || '‚ú® Styling Service';
                    additionalServices.push(`${stylingName} (+${stylingPrice} CHF)`);
                    additionalPrice += stylingPrice;
                }
                
                const totalPrice = selectedService.price + additionalPrice;
                
                summary.classList.remove('hidden');
                content.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <p><strong>${selectedService.fullPath || selectedService.name}</strong></p>
                            ${additionalServices.length > 0 ? `<p class="text-white/80 text-sm">${additionalServices.join(', ')}</p>` : ''}
                            <p>${selectedDate} um ${selectedTime}</p>
                            <p>Dauer: ${selectedService.duration} Minuten</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold">${totalPrice} CHF</p>
                            ${additionalPrice > 0 ? `<p class="text-white/70 text-sm">(Basis: ${selectedService.price} CHF + ${additionalPrice} CHF)</p>` : ''}
                        </div>
                    </div>
                `;
            } else {
                summary.classList.add('hidden');
            }
        }

        function checkBookingComplete() {
            const bookButton = document.getElementById('bookButton');
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            
            if (selectedService && selectedDate && selectedTime && name && phone) {
                bookButton.disabled = false;
            } else {
                bookButton.disabled = true;
            }
        }

        // Book button event
        document.getElementById('bookButton').addEventListener('click', function() {
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            
            if (!name || !phone) {
                alert('Bitte f√ºllen Sie alle Felder aus.');
                return;
            }
            
            // Calculate additional services with saved prices
            let additionalServices = [];
            let additionalPrice = 0;
            
            if (document.getElementById('designService').checked) {
                const designPrice = parseInt(localStorage.getItem('barbershop_design_service_price') || '15');
                const designName = localStorage.getItem('barbershop_design_service_name') || 'Premium Design';
                additionalServices.push({ name: designName.replace(/üé®\s*/, ''), price: designPrice });
                additionalPrice += designPrice;
            }
            
            if (document.getElementById('stylingService').checked) {
                const stylingPrice = parseInt(localStorage.getItem('barbershop_styling_service_price') || '20');
                const stylingName = localStorage.getItem('barbershop_styling_service_name') || 'Styling Service';
                additionalServices.push({ name: stylingName.replace(/‚ú®\s*/, ''), price: stylingPrice });
                additionalPrice += stylingPrice;
            }
            
            const totalPrice = selectedService.price + additionalPrice;
            
            const booking = {
                id: Date.now(),
                service: selectedService,
                additionalServices: additionalServices,
                totalPrice: totalPrice,
                date: selectedDate,
                time: selectedTime,
                customer: { name, phone },
                timestamp: new Date().toISOString()
            };
            
            bookings.push(booking);
            localStorage.setItem('barbershop_bookings', JSON.stringify(bookings));
            
            // Send automatic notifications
            sendBookingNotifications(booking);
            
            const additionalText = additionalServices.length > 0 ? 
                `\nZus√§tzliche Services: ${additionalServices.map(s => s.name).join(', ')}` : '';
            
            alert(`‚úÖ Termin erfolgreich gebucht!\n\n${selectedService.name}${additionalText}\n${selectedDate} um ${selectedTime}\nGesamtpreis: ${totalPrice} CHF\n\nWir freuen uns auf Ihren Besuch!`);
            
            // Reset form
            resetForm();
            updateAdminStats();
            if (!document.getElementById('adminPanel').classList.contains('hidden')) {
                displayBookings();
            }
        });

        function resetForm() {
            selectedService = null;
            selectedDate = null;
            selectedTime = null;
            
            document.querySelectorAll('.service-option').forEach(opt => opt.classList.remove('ring-2', 'ring-white'));
            document.getElementById('bookingDate').value = '';
            document.getElementById('customerName').value = '';
            document.getElementById('customerPhone').value = '';
            document.getElementById('designService').checked = false;
            document.getElementById('stylingService').checked = false;
            document.getElementById('timeSlots').innerHTML = '';
            document.getElementById('bookingSummary').classList.add('hidden');
            document.getElementById('bookButton').disabled = true;
        }

        // Admin Panel with Password Protection
        function setupAdminPanel() {
            document.getElementById('adminToggle').addEventListener('click', function() {
                const adminPanel = document.getElementById('adminPanel');
                if (adminPanel.classList.contains('hidden')) {
                    // Check if already authenticated in this session
                    if (sessionStorage.getItem('admin_authenticated') === 'true') {
                        adminPanel.classList.remove('hidden');
                        displayBookings();
                        return;
                    }
                    
                    // Prompt for password
                    const password = prompt('üîí Admin-Passwort eingeben:');
                    if (password === 'admin123') {
                        sessionStorage.setItem('admin_authenticated', 'true');
                        adminPanel.classList.remove('hidden');
                        displayBookings();
                        alert('‚úÖ Erfolgreich angemeldet!');
                    } else if (password !== null) {
                        alert('‚ùå Falsches Passwort!');
                    }
                } else {
                    adminPanel.classList.add('hidden');
                }
            });

            // Logout functionality
            document.getElementById('logoutButton').addEventListener('click', function() {
                sessionStorage.removeItem('admin_authenticated');
                document.getElementById('adminPanel').classList.add('hidden');
                alert('üëã Erfolgreich abgemeldet!');
            });
        }

        function displayBookings() {
            const bookingsList = document.getElementById('bookingsList');
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(booking => booking.date === today);
            
            if (todayBookings.length === 0) {
                bookingsList.innerHTML = '<p class="text-white/70">Keine Termine f√ºr heute</p>';
                return;
            }
            
            bookingsList.innerHTML = todayBookings
                .sort((a, b) => a.time.localeCompare(b.time))
                .map(booking => {
                    const additionalServicesText = booking.additionalServices && booking.additionalServices.length > 0 
                        ? `<p class="text-white/60 text-xs">+ ${booking.additionalServices.map(s => s.name).join(', ')}</p>`
                        : '';
                    
                    const displayPrice = booking.totalPrice || booking.service.price;
                    
                    return `
                        <div class="booking-card bg-white/10 rounded-lg p-4">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="text-white font-medium">${booking.customer.name}</h4>
                                    <p class="text-white/70 text-sm">${booking.service.name}</p>
                                    ${additionalServicesText}
                                    <p class="text-white/70 text-sm">üìû ${booking.customer.phone}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-white font-bold">${booking.time}</p>
                                    <p class="text-white/70 text-sm">${displayPrice} CHF</p>
                                    <div class="mt-2 space-x-2">
                                        <button onclick="sendWhatsApp('${booking.customer.phone}', '${booking.customer.name}', '${booking.service.name}', '${booking.date}', '${booking.time}')" class="whatsapp-btn text-xs px-2 py-1 rounded">
                                            üì± WhatsApp
                                        </button>
                                        <button onclick="cancelBooking(${booking.id})" class="text-red-400 hover:text-red-300 text-xs px-2 py-1 rounded bg-red-500/20">
                                            ‚ùå Stornieren
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
        }

        function sendWhatsApp(phone, name, service, date, time) {
            // Clean phone number (remove spaces, dashes, etc.)
            const cleanPhone = phone.replace(/\D/g, '');
            
            // Format message
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            const message = `Hallo ${name}! üëã

Erinnerung an Ihren Termin:
üìÖ ${date} um ${time}
‚úÇÔ∏è ${service}

Wir freuen uns auf Ihren Besuch!

Ihr ${businessName} Team`;
            
            // Create WhatsApp URL
            const whatsappUrl = `https://wa.me/${cleanPhone}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp
            window.open(whatsappUrl, '_blank');
        }

        function sendBookingNotifications(booking) {
            const ownerPhone = localStorage.getItem('barbershop_owner_whatsapp');
            const autoNotify = localStorage.getItem('barbershop_auto_notify') === 'true';
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            // Send confirmation to customer
            sendCustomerConfirmation(booking);
            
            // Send notification to owner if enabled
            if (autoNotify && ownerPhone) {
                sendOwnerNotification(booking, ownerPhone);
            }
        }

        function sendCustomerConfirmation(booking) {
            const cleanPhone = booking.customer.phone.replace(/\D/g, '');
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            // Use custom template if available
            let template = localStorage.getItem('barbershop_customer_template');
            if (!template) {
                template = `‚úÖ Buchungsbest√§tigung

Hallo {name}!

Ihr Termin wurde erfolgreich gebucht:
üìÖ {date} um {time}
‚úÇÔ∏è {service}
üí∞ {price} CHF

Wir freuen uns auf Ihren Besuch!

{businessName}`;
            }

            // Replace placeholders
            const message = template
                .replace(/{name}/g, booking.customer.name)
                .replace(/{date}/g, booking.date)
                .replace(/{time}/g, booking.time)
                .replace(/{service}/g, booking.service.name)
                .replace(/{price}/g, booking.service.price)
                .replace(/{businessName}/g, businessName);
            
            const whatsappUrl = `https://wa.me/${cleanPhone}?text=${encodeURIComponent(message)}`;
            
            // Auto-open WhatsApp for customer confirmation
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 1000);
        }

        function sendOwnerNotification(booking, ownerPhone) {
            const cleanOwnerPhone = ownerPhone.replace(/\D/g, '');
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            // Use custom template if available
            let template = localStorage.getItem('barbershop_owner_template');
            if (!template) {
                template = `üîî Neue Buchung!

Kunde: {name}
üìû {phone}
üìÖ {date} um {time}
‚úÇÔ∏è {service}
üí∞ {price} CHF

{businessName} - Admin`;
            }

            // Replace placeholders
            const message = template
                .replace(/{name}/g, booking.customer.name)
                .replace(/{phone}/g, booking.customer.phone)
                .replace(/{date}/g, booking.date)
                .replace(/{time}/g, booking.time)
                .replace(/{service}/g, booking.service.name)
                .replace(/{price}/g, booking.service.price)
                .replace(/{businessName}/g, businessName);
            
            const whatsappUrl = `https://wa.me/${cleanOwnerPhone}?text=${encodeURIComponent(message)}`;
            
            // Auto-open WhatsApp for owner notification
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 2000);
        }

        function cancelBooking(bookingId) {
            if (confirm('Termin wirklich stornieren?')) {
                bookings = bookings.filter(booking => booking.id !== bookingId);
                localStorage.setItem('barbershop_bookings', JSON.stringify(bookings));
                displayBookings();
                updateAdminStats();
                generateTimeSlots(); // Refresh available slots
            }
        }

        function updateAdminStats() {
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(booking => booking.date === today);
            const todayRevenue = todayBookings.reduce((sum, booking) => {
                return sum + (booking.totalPrice || booking.service.price);
            }, 0);
            
            document.getElementById('todayBookings').textContent = todayBookings.length;
            document.getElementById('todayRevenue').textContent = todayRevenue + ' CHF';
            document.getElementById('totalBookings').textContent = bookings.length;
        }

        // Service Management Setup
        function setupServiceManagement() {
            document.getElementById('serviceToggle').addEventListener('click', function() {
                const servicePanel = document.getElementById('servicePanel');
                servicePanel.classList.toggle('open');
                if (servicePanel.classList.contains('open')) {
                    loadAdminServices();
                    setupServiceViewToggle();
                }
            });

            // Create new category
            document.getElementById('createCategoryBtn').addEventListener('click', function() {
                const categoryName = document.getElementById('newCategoryName').value;
                const categoryEmoji = document.getElementById('newCategoryEmoji').value || '‚úÇÔ∏è';

                if (!categoryName) {
                    alert('Bitte Kategorie-Name eingeben!');
                    return;
                }

                const newCategory = {
                    id: Date.now(),
                    name: categoryName,
                    emoji: categoryEmoji,
                    type: 'category',
                    subcategories: []
                };

                services.push(newCategory);
                localStorage.setItem('barbershop_services', JSON.stringify(services));

                // Clear form
                document.getElementById('newCategoryName').value = '';
                document.getElementById('newCategoryEmoji').value = '';

                // Update dropdowns
                updateCategoryDropdowns();
                loadServices();
                loadAdminServices();
                showNotification('‚úÖ Kategorie erstellt!');
            });

            // Create new subcategory
            document.getElementById('createSubcategoryBtn').addEventListener('click', function() {
                const categoryId = parseInt(document.getElementById('selectCategoryForSub').value);
                const subcategoryName = document.getElementById('newSubcategoryName').value;

                if (!categoryId || !subcategoryName) {
                    alert('Bitte Kategorie und Unterkategorie-Name ausw√§hlen/eingeben!');
                    return;
                }

                const category = services.find(s => s.id === categoryId);
                if (!category) {
                    alert('Kategorie nicht gefunden!');
                    return;
                }

                const newSubcategory = {
                    id: Date.now(),
                    name: subcategoryName,
                    type: 'subcategory',
                    options: []
                };

                if (!category.subcategories) {
                    category.subcategories = [];
                }
                category.subcategories.push(newSubcategory);

                localStorage.setItem('barbershop_services', JSON.stringify(services));

                // Clear form
                document.getElementById('selectCategoryForSub').value = '';
                document.getElementById('newSubcategoryName').value = '';

                // Update dropdowns
                updateCategoryDropdowns();
                loadServices();
                loadAdminServices();
                showNotification('‚úÖ Unterkategorie hinzugef√ºgt!');
            });

            // Category selection change handler
            document.getElementById('newServiceCategory').addEventListener('change', function() {
                const selectedCategory = this.value;
                const subcategorySelection = document.getElementById('subcategorySelection');
                const subcategorySelect = document.getElementById('newServiceSubcategory');

                if (selectedCategory && selectedCategory !== 'simple') {
                    const categoryId = parseInt(selectedCategory);
                    const category = services.find(s => s.id === categoryId);
                    
                    if (category && category.subcategories && category.subcategories.length > 0) {
                        // Show subcategory selection
                        subcategorySelection.style.display = 'grid';
                        subcategorySelect.innerHTML = '<option value="">Unterkategorie w√§hlen</option>';
                        
                        category.subcategories.forEach(sub => {
                            const option = document.createElement('option');
                            option.value = sub.id;
                            option.textContent = sub.name;
                            subcategorySelect.appendChild(option);
                        });
                    } else {
                        subcategorySelection.style.display = 'none';
                    }
                } else {
                    subcategorySelection.style.display = 'none';
                }
            });

            document.getElementById('addServiceBtn').addEventListener('click', function() {
                const name = document.getElementById('newServiceName').value;
                const description = document.getElementById('newServiceDescription').value;
                const price = parseInt(document.getElementById('newServicePrice').value);
                const duration = parseInt(document.getElementById('newServiceDuration').value);
                const emoji = document.getElementById('newServiceEmoji').value || '‚≠ê';
                const categoryId = document.getElementById('newServiceCategory').value;
                const subcategoryId = document.getElementById('newServiceSubcategory').value;
                const featured = document.getElementById('newServiceFeatured').checked;

                if (!name || !description || !price || !duration) {
                    alert('Bitte alle Felder ausf√ºllen!');
                    return;
                }

                const newService = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    duration,
                    emoji,
                    featured
                };

                // Add service to appropriate location
                if (categoryId && categoryId !== 'simple') {
                    const categoryIdNum = parseInt(categoryId);
                    const category = services.find(s => s.id === categoryIdNum);
                    
                    if (category && subcategoryId) {
                        // Add to specific subcategory
                        const subcategoryIdNum = parseInt(subcategoryId);
                        const subcategory = category.subcategories.find(s => s.id === subcategoryIdNum);
                        
                        if (subcategory) {
                            if (!subcategory.options) subcategory.options = [];
                            subcategory.options.push(newService);
                        }
                    } else if (category) {
                        // Create default subcategory if none exists
                        if (!category.subcategories) category.subcategories = [];
                        if (category.subcategories.length === 0) {
                            category.subcategories.push({
                                id: Date.now() + 1,
                                name: 'Standard',
                                type: 'subcategory',
                                options: []
                            });
                        }
                        category.subcategories[0].options.push(newService);
                    }
                } else {
                    // Add as simple service
                    newService.type = 'simple';
                    services.push(newService);
                }

                localStorage.setItem('barbershop_services', JSON.stringify(services));
                
                // Clear form
                document.getElementById('newServiceName').value = '';
                document.getElementById('newServiceDescription').value = '';
                document.getElementById('newServicePrice').value = '';
                document.getElementById('newServiceDuration').value = '';
                document.getElementById('newServiceEmoji').value = '';
                document.getElementById('newServiceCategory').value = '';
                document.getElementById('newServiceSubcategory').value = '';
                document.getElementById('newServiceFeatured').checked = false;
                document.getElementById('subcategorySelection').style.display = 'none';

                loadServices();
                loadAdminServices();
                showNotification('‚úÖ Service hinzugef√ºgt!');
            });

            // Save all services button
            document.getElementById('saveAllServices').addEventListener('click', function() {
                services.forEach(service => {
                    applyServiceChanges(service.id);
                });
                setTimeout(() => {
                    showNotification('üíæ Alle Services gespeichert!');
                }, 500);
            });

            // Preview all services button
            document.getElementById('previewAllServices').addEventListener('click', function() {
                services.forEach(service => {
                    applyServiceChanges(service.id);
                });
                setTimeout(() => {
                    showNotification('üëÅÔ∏è Alle Service-√Ñnderungen angewendet!');
                }, 500);
            });

            // Reset all services button
            document.getElementById('resetAllServices').addEventListener('click', function() {
                if (confirm('Wirklich alle Services l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden!')) {
                    services = [];
                    localStorage.setItem('barbershop_services', JSON.stringify(services));
                    loadServices();
                    loadAdminServices();
                    showNotification('üîÑ Alle Services gel√∂scht!');
                }
            });
        }

        // Apply changes to individual service
        function applyServiceChanges(serviceId) {
            const name = document.getElementById(`serviceName_${serviceId}`).value;
            const description = document.getElementById(`serviceDescription_${serviceId}`).value;
            const price = parseInt(document.getElementById(`servicePrice_${serviceId}`).value);
            const duration = parseInt(document.getElementById(`serviceDuration_${serviceId}`).value);
            const emoji = document.getElementById(`serviceEmoji_${serviceId}`).value;
            const featured = document.getElementById(`serviceDesign_${serviceId}`).checked;

            if (!name || !price || !duration || !emoji) {
                alert('Bitte alle Pflichtfelder ausf√ºllen!');
                return;
            }

            // Find and update the service in the nested structure
            let updated = false;
            
            services.forEach(service => {
                if (service.type === 'simple' && service.id === serviceId) {
                    // Update simple service
                    service.name = name;
                    service.description = description;
                    service.price = price;
                    service.duration = duration;
                    service.emoji = emoji;
                    service.featured = featured;
                    updated = true;
                } else if (service.type === 'category' && service.subcategories) {
                    // Update service in category
                    service.subcategories.forEach(subcategory => {
                        if (subcategory.options) {
                            subcategory.options.forEach(option => {
                                if (option.id === serviceId) {
                                    option.name = name;
                                    option.description = description;
                                    option.price = price;
                                    option.duration = duration;
                                    option.emoji = emoji;
                                    option.featured = featured;
                                    updated = true;
                                }
                            });
                        }
                    });
                }
            });

            if (updated) {
                // Save to localStorage
                localStorage.setItem('barbershop_services', JSON.stringify(services));

                // Reload services display
                loadServices();
                loadAdminServices();

                showNotification(`‚ú® ${name} aktualisiert!`);
            } else {
                alert('Service nicht gefunden!');
            }
        }

        // Working Hours Panel Setup
        function setupWorkingHoursPanel() {
            document.getElementById('hoursToggle').addEventListener('click', function() {
                const hoursPanel = document.getElementById('hours<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97af5b3a61955da5',t:'MTc1NzE3NjI4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
