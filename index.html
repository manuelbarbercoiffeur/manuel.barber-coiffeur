<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barbershop Terminbuchung</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;500;600;700&family=Squada+One&family=Oswald:wght@300;400;500;600;700&family=Bebas+Neue&family=Anton&display=swap');
        body { font-family: var(--text-font, 'Inter'), sans-serif; }
        h1, h2, h3, .title-font { font-family: var(--title-font, 'Squada One'), cursive; font-size: 1.2em; }
        h1 { font-size: 2.5rem; }
        h2 { font-size: 1.8rem; }
        h3 { font-size: 1.4rem; }
        .gradient-bg { background: linear-gradient(135deg, var(--primary-color, #2563eb) 0%, var(--secondary-color, #1e40af) 100%); }
        .glass-effect { backdrop-filter: blur(10px); background: rgba(255, 255, 255, 0.1); }
        .booking-card { transition: all 0.3s ease; }
        .booking-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .logo-container { width: 80px; height: 80px; border-radius: 50%; overflow: hidden; margin: 0 auto 1rem; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; }
        .logo-container img { width: 100%; height: 100%; object-fit: cover; }
        .whatsapp-btn { background: #25D366; color: white; }
        .whatsapp-btn:hover { background: #128C7E; }
        .design-panel { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .design-panel.open { max-height: 500px; }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div id="logoContainer" class="logo-container">
                <span class="text-3xl">‚úÇÔ∏è</span>
            </div>
            <h1 class="text-4xl font-bold text-white mb-2" id="businessName">Barbershop Elite</h1>
            <p class="text-white/80 text-lg">Professionelle Herrenfriseur-Services</p>
        </div>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto">
            <!-- Booking Form -->
            <div id="bookingForm" class="glass-effect rounded-2xl p-8 mb-8">
                <h2 class="text-2xl font-semibold text-white mb-6">üóìÔ∏è Termin buchen</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Service Selection -->
                    <div>
                        <label class="block text-white font-medium mb-3">Service w√§hlen</label>
                        <div id="servicesList" class="space-y-3">
                            <!-- Services will be loaded here -->
                        </div>
                    </div>

                    <!-- Date & Time Selection -->
                    <div>
                        <label class="block text-white font-medium mb-3">Datum & Uhrzeit</label>
                        <div class="space-y-4">
                            <input type="date" id="bookingDate" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            
                            <div id="timeSlots" class="grid grid-cols-3 gap-2">
                                <!-- Time slots will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customer Info -->
                <div class="mt-6 grid md:grid-cols-2 gap-4">
                    <input type="text" id="customerName" placeholder="Ihr Name" class="p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                    <input type="tel" id="customerPhone" placeholder="Telefonnummer" class="p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                </div>

                <!-- Booking Summary -->
                <div id="bookingSummary" class="mt-6 bg-white/10 rounded-lg p-4 hidden">
                    <h3 class="text-white font-medium mb-2">Buchungs√ºbersicht</h3>
                    <div id="summaryContent" class="text-white/80 text-sm"></div>
                </div>

                <!-- Book Button -->
                <button id="bookButton" class="w-full mt-6 bg-white text-purple-600 font-semibold py-3 px-6 rounded-lg hover:bg-white/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Termin buchen
                </button>
            </div>

            <!-- Admin Panel Toggle -->
            <div class="text-center mb-4">
                <button id="adminToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-4 py-2 rounded-lg hover:bg-white/20 transition-all">
                    üîß Admin-Bereich
                </button>
            </div>



            <!-- Admin Panel -->
            <div id="adminPanel" class="glass-effect rounded-2xl p-8 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-white">üë®‚Äçüíº Admin-Bereich</h2>
                    <div class="space-x-2">
                        <button id="serviceToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            ‚öôÔ∏è Services
                        </button>
                        <button id="designToggle" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üé® Design
                        </button>
                        <button id="logoutButton" class="text-white/70 hover:text-white text-sm bg-white/10 px-3 py-1 rounded">
                            üö™ Abmelden
                        </button>
                    </div>
                </div>

                <!-- Service Management Panel -->
                <div id="servicePanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">‚öôÔ∏è Services verwalten</h3>
                    
                    <!-- Add New Service -->
                    <div class="bg-white/5 rounded-lg p-4 mb-4">
                        <h4 class="text-white font-medium mb-3">Neuen Service hinzuf√ºgen</h4>
                        <div class="grid md:grid-cols-4 gap-3">
                            <input type="text" id="newServiceName" placeholder="Service Name" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            <input type="text" id="newServiceDescription" placeholder="Beschreibung" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            <input type="number" id="newServicePrice" placeholder="Preis ‚Ç¨" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                            <input type="number" id="newServiceDuration" placeholder="Dauer Min" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                        </div>
                        <div class="mt-3 flex gap-2">
                            <input type="text" id="newServiceEmoji" placeholder="Emoji (z.B. ‚úÇÔ∏è)" class="p-2 rounded bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none w-24">
                            <button id="addServiceBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded transition-all">
                                ‚ûï Hinzuf√ºgen
                            </button>
                        </div>
                    </div>

                    <!-- Services List -->
                    <div id="adminServicesList" class="space-y-2">
                        <!-- Admin services list will be loaded here -->
                    </div>
                </div>

                <!-- Design Panel -->
                <div id="designPanel" class="bg-white/5 rounded-xl p-6 mb-6 design-panel">
                    <h3 class="text-xl font-semibold text-white mb-4">üé® Design anpassen</h3>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Logo Upload -->
                        <div>
                            <label class="block text-white font-medium mb-3">Logo hochladen</label>
                            <input type="file" id="logoUpload" accept="image/*" class="w-full p-3 rounded-lg bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-white file:text-purple-600 hover:file:bg-gray-100">
                            <p class="text-white/60 text-sm mt-2">JPG, PNG oder GIF (max. 2MB)</p>
                        </div>

                        <!-- Business Name -->
                        <div>
                            <label class="block text-white font-medium mb-3">Gesch√§ftsname</label>
                            <input type="text" id="businessNameInput" placeholder="Barbershop Elite" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                        </div>

                        <!-- Custom Colors -->
                        <div>
                            <label class="block text-white font-medium mb-3">Hauptfarbe (Hex)</label>
                            <div class="flex gap-2">
                                <input type="text" id="primaryColorInput" placeholder="#2563eb" class="flex-1 p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="color" id="primaryColorPicker" class="w-12 h-12 rounded-lg border border-white/20 bg-white/10">
                            </div>
                        </div>

                        <div>
                            <label class="block text-white font-medium mb-3">Zweitfarbe (Hex)</label>
                            <div class="flex gap-2">
                                <input type="text" id="secondaryColorInput" placeholder="#1e40af" class="flex-1 p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                <input type="color" id="secondaryColorPicker" class="w-12 h-12 rounded-lg border border-white/20 bg-white/10">
                            </div>
                        </div>

                        <!-- Title Font Selection -->
                        <div>
                            <label class="block text-white font-medium mb-3">Titel-Schriftart</label>
                            <select id="titleFontSelect" class="w-full p-3 rounded-lg bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                <option value="Squada One">Squada One (Standard)</option>
                                <option value="Oswald">Oswald (Stark)</option>
                                <option value="Bebas Neue">Bebas Neue (Modern)</option>
                                <option value="Anton">Anton (Bold)</option>
                            </select>
                        </div>

                        <!-- Text Font Selection -->
                        <div>
                            <label class="block text-white font-medium mb-3">Text-Schriftart</label>
                            <select id="textFontSelect" class="w-full p-3 rounded-lg bg-white/10 text-white border border-white/20 focus:border-white/50 focus:outline-none">
                                <option value="Inter">Inter (Passend zu Squada One)</option>
                                <option value="Poppins">Poppins (Freundlich)</option>
                                <option value="Roboto">Roboto (Klassisch)</option>
                                <option value="Open Sans">Open Sans (Sauber)</option>
                            </select>
                        </div>

                        <!-- WhatsApp Settings -->
                        <div class="md:col-span-2">
                            <label class="block text-white font-medium mb-3">WhatsApp Einstellungen</label>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Inhaber WhatsApp (f√ºr Buchungsbenachrichtigungen)</label>
                                    <input type="tel" id="ownerWhatsApp" placeholder="+49123456789" class="w-full p-3 rounded-lg bg-white/10 text-white placeholder-white/50 border border-white/20 focus:border-white/50 focus:outline-none">
                                </div>
                                <div class="flex items-end">
                                    <label class="flex items-center text-white/70 text-sm">
                                        <input type="checkbox" id="autoNotifyOwner" class="mr-2">
                                        Automatische Benachrichtigung bei neuen Buchungen
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 flex gap-4">
                        <button id="saveDesign" class="bg-white text-purple-600 font-semibold py-2 px-6 rounded-lg hover:bg-white/90 transition-all">
                            üíæ Design speichern
                        </button>
                        <button id="resetDesign" class="bg-white/20 text-white font-semibold py-2 px-6 rounded-lg hover:bg-white/30 transition-all">
                            üîÑ Zur√ºcksetzen
                        </button>
                    </div>
                </div>
                
                <!-- Bookings List -->
                <div class="mb-6">
                    <h3 class="text-white font-medium mb-4">Heutige Termine</h3>
                    <div id="bookingsList" class="space-y-3">
                        <!-- Bookings will be displayed here -->
                    </div>
                </div>

                <!-- Statistics -->
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="todayBookings">0</div>
                        <div class="text-white/70 text-sm">Heute</div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="todayRevenue">0‚Ç¨</div>
                        <div class="text-white/70 text-sm">Umsatz</div>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <div class="text-2xl font-bold text-white" id="totalBookings">0</div>
                        <div class="text-white/70 text-sm">Gesamt</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let selectedService = null;
        let selectedDate = null;
        let selectedTime = null;
        let bookings = JSON.parse(localStorage.getItem('barbershop_bookings')) || [];
        let services = JSON.parse(localStorage.getItem('barbershop_services')) || [
            { id: 1, name: 'Herrenhaarschnitt', description: 'Klassischer Schnitt mit Styling', price: 25, duration: 30, emoji: '‚úÇÔ∏è' },
            { id: 2, name: 'Bartpflege', description: 'Trimmen und Styling', price: 15, duration: 20, emoji: 'üßî' },
            { id: 3, name: 'Komplett-Paket', description: 'Haarschnitt + Bartpflege', price: 35, duration: 45, emoji: 'üí´' }
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            loadDesignSettings();
        });

        function initializeApp() {
            loadServices();
            setupServiceSelection();
            setupDateSelection();
            setupAdminPanel();
            setupDesignPanel();
            setupServiceManagement();
            updateAdminStats();
            setMinDate();
        }

        function setMinDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('bookingDate').min = today;
        }

        function loadServices() {
            const servicesList = document.getElementById('servicesList');
            servicesList.innerHTML = '';
            
            services.forEach(service => {
                const serviceElement = document.createElement('div');
                serviceElement.className = 'service-option bg-white/10 rounded-lg p-4 cursor-pointer hover:bg-white/20 transition-all';
                serviceElement.dataset.serviceId = service.id;
                serviceElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-white font-medium">${service.emoji} ${service.name}</h3>
                            <p class="text-white/70 text-sm">${service.description}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-white font-bold">${service.price}‚Ç¨</p>
                            <p class="text-white/70 text-sm">${service.duration} Min</p>
                        </div>
                    </div>
                `;
                servicesList.appendChild(serviceElement);
            });
            
            setupServiceSelection();
        }

        function loadAdminServices() {
            const adminServicesList = document.getElementById('adminServicesList');
            adminServicesList.innerHTML = '';
            
            services.forEach(service => {
                const serviceElement = document.createElement('div');
                serviceElement.className = 'bg-white/10 rounded-lg p-3 flex justify-between items-center';
                serviceElement.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-xl">${service.emoji}</span>
                        <div>
                            <h4 class="text-white font-medium">${service.name}</h4>
                            <p class="text-white/70 text-sm">${service.description} - ${service.price}‚Ç¨ (${service.duration} Min)</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editService(${service.id})" class="text-blue-400 hover:text-blue-300 text-sm px-2 py-1 rounded bg-blue-500/20">
                            ‚úèÔ∏è Bearbeiten
                        </button>
                        <button onclick="deleteService(${service.id})" class="text-red-400 hover:text-red-300 text-sm px-2 py-1 rounded bg-red-500/20">
                            üóëÔ∏è L√∂schen
                        </button>
                    </div>
                `;
                adminServicesList.appendChild(serviceElement);
            });
        }

        function setupServiceSelection() {
            const serviceOptions = document.querySelectorAll('.service-option');
            serviceOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove previous selection
                    serviceOptions.forEach(opt => opt.classList.remove('ring-2', 'ring-white'));
                    
                    // Add selection to clicked option
                    this.classList.add('ring-2', 'ring-white');
                    
                    const serviceId = parseInt(this.dataset.serviceId);
                    const service = services.find(s => s.id === serviceId);
                    
                    selectedService = {
                        id: service.id,
                        name: service.name,
                        price: service.price,
                        duration: service.duration,
                        emoji: service.emoji
                    };
                    
                    updateBookingSummary();
                    checkBookingComplete();
                });
            });
        }

        function setupDateSelection() {
            const dateInput = document.getElementById('bookingDate');
            dateInput.addEventListener('change', function() {
                selectedDate = this.value;
                generateTimeSlots();
                updateBookingSummary();
                checkBookingComplete();
            });
        }

        function generateTimeSlots() {
            const timeSlotsContainer = document.getElementById('timeSlots');
            timeSlotsContainer.innerHTML = '';
            
            const times = ['09:00', '09:30', '10:00', '10:30', '11:00', '11:30', '14:00', '14:30', '15:00', '15:30', '16:00', '16:30', '17:00', '17:30'];
            
            times.forEach(time => {
                const isBooked = bookings.some(booking => 
                    booking.date === selectedDate && booking.time === time
                );
                
                const timeSlot = document.createElement('button');
                timeSlot.className = `p-2 rounded text-sm transition-all ${
                    isBooked 
                        ? 'bg-red-500/20 text-red-300 cursor-not-allowed' 
                        : 'bg-white/10 text-white hover:bg-white/20'
                }`;
                timeSlot.textContent = time;
                timeSlot.disabled = isBooked;
                
                if (!isBooked) {
                    timeSlot.addEventListener('click', function() {
                        // Remove previous selection
                        document.querySelectorAll('#timeSlots button').forEach(btn => {
                            btn.classList.remove('ring-2', 'ring-white');
                        });
                        
                        // Add selection
                        this.classList.add('ring-2', 'ring-white');
                        selectedTime = time;
                        updateBookingSummary();
                        checkBookingComplete();
                    });
                }
                
                timeSlotsContainer.appendChild(timeSlot);
            });
        }

        function updateBookingSummary() {
            const summary = document.getElementById('bookingSummary');
            const content = document.getElementById('summaryContent');
            
            if (selectedService && selectedDate && selectedTime) {
                summary.classList.remove('hidden');
                content.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <p><strong>${selectedService.name}</strong></p>
                            <p>${selectedDate} um ${selectedTime}</p>
                            <p>Dauer: ${selectedService.duration} Minuten</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold">${selectedService.price}‚Ç¨</p>
                        </div>
                    </div>
                `;
            } else {
                summary.classList.add('hidden');
            }
        }

        function checkBookingComplete() {
            const bookButton = document.getElementById('bookButton');
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            
            if (selectedService && selectedDate && selectedTime && name && phone) {
                bookButton.disabled = false;
            } else {
                bookButton.disabled = true;
            }
        }

        // Book button event
        document.getElementById('bookButton').addEventListener('click', function() {
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            
            if (!name || !phone) {
                alert('Bitte f√ºllen Sie alle Felder aus.');
                return;
            }
            
            const booking = {
                id: Date.now(),
                service: selectedService,
                date: selectedDate,
                time: selectedTime,
                customer: { name, phone },
                timestamp: new Date().toISOString()
            };
            
            bookings.push(booking);
            localStorage.setItem('barbershop_bookings', JSON.stringify(bookings));
            
            // Send automatic notifications
            sendBookingNotifications(booking);
            
            alert(`‚úÖ Termin erfolgreich gebucht!\n\n${selectedService.name}\n${selectedDate} um ${selectedTime}\n\nWir freuen uns auf Ihren Besuch!`);
            
            // Reset form
            resetForm();
            updateAdminStats();
            if (!document.getElementById('adminPanel').classList.contains('hidden')) {
                displayBookings();
            }
        });

        function resetForm() {
            selectedService = null;
            selectedDate = null;
            selectedTime = null;
            
            document.querySelectorAll('.service-option').forEach(opt => opt.classList.remove('ring-2', 'ring-white'));
            document.getElementById('bookingDate').value = '';
            document.getElementById('customerName').value = '';
            document.getElementById('customerPhone').value = '';
            document.getElementById('timeSlots').innerHTML = '';
            document.getElementById('bookingSummary').classList.add('hidden');
            document.getElementById('bookButton').disabled = true;
        }

        // Admin Panel with Password Protection
        function setupAdminPanel() {
            document.getElementById('adminToggle').addEventListener('click', function() {
                const adminPanel = document.getElementById('adminPanel');
                if (adminPanel.classList.contains('hidden')) {
                    // Check if already authenticated in this session
                    if (sessionStorage.getItem('admin_authenticated') === 'true') {
                        adminPanel.classList.remove('hidden');
                        displayBookings();
                        return;
                    }
                    
                    // Prompt for password
                    const password = prompt('üîí Admin-Passwort eingeben:');
                    if (password === 'barbershop2024') {
                        sessionStorage.setItem('admin_authenticated', 'true');
                        adminPanel.classList.remove('hidden');
                        displayBookings();
                        alert('‚úÖ Erfolgreich angemeldet!');
                    } else if (password !== null) {
                        alert('‚ùå Falsches Passwort!');
                    }
                } else {
                    adminPanel.classList.add('hidden');
                }
            });

            // Logout functionality
            document.getElementById('logoutButton').addEventListener('click', function() {
                sessionStorage.removeItem('admin_authenticated');
                document.getElementById('adminPanel').classList.add('hidden');
                alert('üëã Erfolgreich abgemeldet!');
            });
        }

        function displayBookings() {
            const bookingsList = document.getElementById('bookingsList');
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(booking => booking.date === today);
            
            if (todayBookings.length === 0) {
                bookingsList.innerHTML = '<p class="text-white/70">Keine Termine f√ºr heute</p>';
                return;
            }
            
            bookingsList.innerHTML = todayBookings
                .sort((a, b) => a.time.localeCompare(b.time))
                .map(booking => `
                    <div class="booking-card bg-white/10 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="text-white font-medium">${booking.customer.name}</h4>
                                <p class="text-white/70 text-sm">${booking.service.name}</p>
                                <p class="text-white/70 text-sm">üìû ${booking.customer.phone}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-white font-bold">${booking.time}</p>
                                <p class="text-white/70 text-sm">${booking.service.price}‚Ç¨</p>
                                <div class="mt-2 space-x-2">
                                    <button onclick="sendWhatsApp('${booking.customer.phone}', '${booking.customer.name}', '${booking.service.name}', '${booking.date}', '${booking.time}')" class="whatsapp-btn text-xs px-2 py-1 rounded">
                                        üì± WhatsApp
                                    </button>
                                    <button onclick="cancelBooking(${booking.id})" class="text-red-400 hover:text-red-300 text-xs px-2 py-1 rounded bg-red-500/20">
                                        ‚ùå Stornieren
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
        }

        function sendWhatsApp(phone, name, service, date, time) {
            // Clean phone number (remove spaces, dashes, etc.)
            const cleanPhone = phone.replace(/\D/g, '');
            
            // Format message
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            const message = `Hallo ${name}! üëã

Erinnerung an Ihren Termin:
üìÖ ${date} um ${time}
‚úÇÔ∏è ${service}

Wir freuen uns auf Ihren Besuch!

Ihr ${businessName} Team`;
            
            // Create WhatsApp URL
            const whatsappUrl = `https://wa.me/${cleanPhone}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp
            window.open(whatsappUrl, '_blank');
        }

        function sendBookingNotifications(booking) {
            const ownerPhone = localStorage.getItem('barbershop_owner_whatsapp');
            const autoNotify = localStorage.getItem('barbershop_auto_notify') === 'true';
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            // Send confirmation to customer
            sendCustomerConfirmation(booking);
            
            // Send notification to owner if enabled
            if (autoNotify && ownerPhone) {
                sendOwnerNotification(booking, ownerPhone);
            }
        }

        function sendCustomerConfirmation(booking) {
            const cleanPhone = booking.customer.phone.replace(/\D/g, '');
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            const message = `‚úÖ Buchungsbest√§tigung

Hallo ${booking.customer.name}!

Ihr Termin wurde erfolgreich gebucht:
üìÖ ${booking.date} um ${booking.time}
‚úÇÔ∏è ${booking.service.name}
üí∞ ${booking.service.price}‚Ç¨

Wir freuen uns auf Ihren Besuch!

${businessName}`;
            
            const whatsappUrl = `https://wa.me/${cleanPhone}?text=${encodeURIComponent(message)}`;
            
            // Auto-open WhatsApp for customer confirmation
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 1000);
        }

        function sendOwnerNotification(booking, ownerPhone) {
            const cleanOwnerPhone = ownerPhone.replace(/\D/g, '');
            const businessName = localStorage.getItem('barbershop_name') || 'Barbershop Elite';
            
            const message = `üîî Neue Buchung!

Kunde: ${booking.customer.name}
üìû ${booking.customer.phone}
üìÖ ${booking.date} um ${booking.time}
‚úÇÔ∏è ${booking.service.name}
üí∞ ${booking.service.price}‚Ç¨

${businessName} - Admin`;
            
            const whatsappUrl = `https://wa.me/${cleanOwnerPhone}?text=${encodeURIComponent(message)}`;
            
            // Auto-open WhatsApp for owner notification
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 2000);
        }

        function cancelBooking(bookingId) {
            if (confirm('Termin wirklich stornieren?')) {
                bookings = bookings.filter(booking => booking.id !== bookingId);
                localStorage.setItem('barbershop_bookings', JSON.stringify(bookings));
                displayBookings();
                updateAdminStats();
                generateTimeSlots(); // Refresh available slots
            }
        }

        function updateAdminStats() {
            const today = new Date().toISOString().split('T')[0];
            const todayBookings = bookings.filter(booking => booking.date === today);
            const todayRevenue = todayBookings.reduce((sum, booking) => sum + booking.service.price, 0);
            
            document.getElementById('todayBookings').textContent = todayBookings.length;
            document.getElementById('todayRevenue').textContent = todayRevenue + '‚Ç¨';
            document.getElementById('totalBookings').textContent = bookings.length;
        }

        // Service Management Setup
        function setupServiceManagement() {
            document.getElementById('serviceToggle').addEventListener('click', function() {
                const servicePanel = document.getElementById('servicePanel');
                servicePanel.classList.toggle('open');
                if (servicePanel.classList.contains('open')) {
                    loadAdminServices();
                }
            });

            document.getElementById('addServiceBtn').addEventListener('click', function() {
                const name = document.getElementById('newServiceName').value;
                const description = document.getElementById('newServiceDescription').value;
                const price = parseInt(document.getElementById('newServicePrice').value);
                const duration = parseInt(document.getElementById('newServiceDuration').value);
                const emoji = document.getElementById('newServiceEmoji').value || '‚≠ê';

                if (!name || !description || !price || !duration) {
                    alert('Bitte alle Felder ausf√ºllen!');
                    return;
                }

                const newService = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    duration,
                    emoji
                };

                services.push(newService);
                localStorage.setItem('barbershop_services', JSON.stringify(services));
                
                // Clear form
                document.getElementById('newServiceName').value = '';
                document.getElementById('newServiceDescription').value = '';
                document.getElementById('newServicePrice').value = '';
                document.getElementById('newServiceDuration').value = '';
                document.getElementById('newServiceEmoji').value = '';

                loadServices();
                loadAdminServices();
                alert('‚úÖ Service hinzugef√ºgt!');
            });
        }

        function editService(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (!service) return;

            const newName = prompt('Service Name:', service.name);
            if (newName === null) return;

            const newDescription = prompt('Beschreibung:', service.description);
            if (newDescription === null) return;

            const newPrice = prompt('Preis (‚Ç¨):', service.price);
            if (newPrice === null) return;

            const newDuration = prompt('Dauer (Minuten):', service.duration);
            if (newDuration === null) return;

            const newEmoji = prompt('Emoji:', service.emoji);
            if (newEmoji === null) return;

            service.name = newName;
            service.description = newDescription;
            service.price = parseInt(newPrice);
            service.duration = parseInt(newDuration);
            service.emoji = newEmoji;

            localStorage.setItem('barbershop_services', JSON.stringify(services));
            loadServices();
            loadAdminServices();
            alert('‚úÖ Service aktualisiert!');
        }

        function deleteService(serviceId) {
            if (confirm('Service wirklich l√∂schen?')) {
                services = services.filter(s => s.id !== serviceId);
                localStorage.setItem('barbershop_services', JSON.stringify(services));
                loadServices();
                loadAdminServices();
                alert('‚úÖ Service gel√∂scht!');
            }
        }

        // Design Panel Setup
        function setupDesignPanel() {
            document.getElementById('designToggle').addEventListener('click', function() {
                const designPanel = document.getElementById('designPanel');
                designPanel.classList.toggle('open');
            });

            // Logo upload
            document.getElementById('logoUpload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 2 * 1024 * 1024) {
                        alert('Datei zu gro√ü! Maximal 2MB erlaubt.');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const logoContainer = document.getElementById('logoContainer');
                        logoContainer.innerHTML = `<img src="${e.target.result}" alt="Logo">`;
                        localStorage.setItem('barbershop_logo', e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Business name
            document.getElementById('businessNameInput').addEventListener('input', function() {
                const name = this.value || 'Barbershop Elite';
                document.getElementById('businessName').textContent = name;
                localStorage.setItem('barbershop_name', name);
            });

            // Custom color inputs
            document.getElementById('primaryColorInput').addEventListener('input', function() {
                const color = this.value;
                if (isValidHexColor(color)) {
                    document.documentElement.style.setProperty('--primary-color', color);
                    document.getElementById('primaryColorPicker').value = color;
                    localStorage.setItem('barbershop_primary_color', color);
                }
            });

            document.getElementById('primaryColorPicker').addEventListener('input', function() {
                const color = this.value;
                document.documentElement.style.setProperty('--primary-color', color);
                document.getElementById('primaryColorInput').value = color;
                localStorage.setItem('barbershop_primary_color', color);
            });

            document.getElementById('secondaryColorInput').addEventListener('input', function() {
                const color = this.value;
                if (isValidHexColor(color)) {
                    document.documentElement.style.setProperty('--secondary-color', color);
                    document.getElementById('secondaryColorPicker').value = color;
                    localStorage.setItem('barbershop_secondary_color', color);
                }
            });

            document.getElementById('secondaryColorPicker').addEventListener('input', function() {
                const color = this.value;
                document.documentElement.style.setProperty('--secondary-color', color);
                document.getElementById('secondaryColorInput').value = color;
                localStorage.setItem('barbershop_secondary_color', color);
            });

            // Title font selection
            document.getElementById('titleFontSelect').addEventListener('change', function() {
                const font = this.value;
                document.documentElement.style.setProperty('--title-font', font);
                localStorage.setItem('barbershop_title_font', font);
            });

            // Text font selection
            document.getElementById('textFontSelect').addEventListener('change', function() {
                const font = this.value;
                document.documentElement.style.setProperty('--text-font', font);
                localStorage.setItem('barbershop_text_font', font);
            });

            // WhatsApp settings
            document.getElementById('ownerWhatsApp').addEventListener('input', function() {
                localStorage.setItem('barbershop_owner_whatsapp', this.value);
            });

            document.getElementById('autoNotifyOwner').addEventListener('change', function() {
                localStorage.setItem('barbershop_auto_notify', this.checked);
            });

            // Save design
            document.getElementById('saveDesign').addEventListener('click', function() {
                alert('‚úÖ Design gespeichert!');
            });

            // Reset design
            document.getElementById('resetDesign').addEventListener('click', function() {
                if (confirm('Design wirklich zur√ºcksetzen?')) {
                    localStorage.removeItem('barbershop_logo');
                    localStorage.removeItem('barbershop_name');
                    localStorage.removeItem('barbershop_primary_color');
                    localStorage.removeItem('barbershop_secondary_color');
                    localStorage.removeItem('barbershop_title_font');
                    localStorage.removeItem('barbershop_text_font');
                    localStorage.removeItem('barbershop_owner_whatsapp');
                    localStorage.removeItem('barbershop_auto_notify');
                    
                    location.reload();
                }
            });
        }

        function isValidHexColor(hex) {
            return /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(hex);
        }

        function loadDesignSettings() {
            // Load logo
            const savedLogo = localStorage.getItem('barbershop_logo');
            if (savedLogo) {
                document.getElementById('logoContainer').innerHTML = `<img src="${savedLogo}" alt="Logo">`;
            }

            // Load business name
            const savedName = localStorage.getItem('barbershop_name');
            if (savedName) {
                document.getElementById('businessName').textContent = savedName;
                document.getElementById('businessNameInput').value = savedName;
            }

            // Load colors
            const savedPrimary = localStorage.getItem('barbershop_primary_color');
            const savedSecondary = localStorage.getItem('barbershop_secondary_color');
            if (savedPrimary) {
                document.documentElement.style.setProperty('--primary-color', savedPrimary);
                document.getElementById('primaryColorInput').value = savedPrimary;
                document.getElementById('primaryColorPicker').value = savedPrimary;
            }
            if (savedSecondary) {
                document.documentElement.style.setProperty('--secondary-color', savedSecondary);
                document.getElementById('secondaryColorInput').value = savedSecondary;
                document.getElementById('secondaryColorPicker').value = savedSecondary;
            }

            // Load fonts
            const savedTitleFont = localStorage.getItem('barbershop_title_font');
            if (savedTitleFont) {
                document.documentElement.style.setProperty('--title-font', savedTitleFont);
                document.getElementById('titleFontSelect').value = savedTitleFont;
            }

            const savedTextFont = localStorage.getItem('barbershop_text_font');
            if (savedTextFont) {
                document.documentElement.style.setProperty('--text-font', savedTextFont);
                document.getElementById('textFontSelect').value = savedTextFont;
            }

            // Load WhatsApp settings
            const savedOwnerWhatsApp = localStorage.getItem('barbershop_owner_whatsapp');
            if (savedOwnerWhatsApp) {
                document.getElementById('ownerWhatsApp').value = savedOwnerWhatsApp;
            }

            const savedAutoNotify = localStorage.getItem('barbershop_auto_notify');
            if (savedAutoNotify === 'true') {
                document.getElementById('autoNotifyOwner').checked = true;
            }
        }

        // Customer info validation
        document.getElementById('customerName').addEventListener('input', checkBookingComplete);
        document.getElementById('customerPhone').addEventListener('input', checkBookingComplete);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97aed61d631fbe8b',t:'MTc1NzE3MDgzMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
